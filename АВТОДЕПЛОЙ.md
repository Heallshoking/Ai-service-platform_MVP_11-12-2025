# 🚀 АВТОМАТИЧЕСКИЙ ДЕПЛОЙ УЛУЧШЕН!

## ✅ ЧТО СДЕЛАНО:

### 1. Создан скрипт полностью автоматического деплоя
**Файл:** `deploy_auto.sh`

**Возможности:**
- ✅ Автоматическое создание архива
- ✅ Копирование на VPS без ввода пароля
- ✅ Автоматическая сборка на VPS
- ✅ Установка прав доступа
- ✅ Цветной вывод прогресса
- ✅ Автоочистка временных файлов

### 2. Использует expect для автоматизации SSH
Больше не нужно вводить пароль вручную!

---

## 🎯 КАК ИСПОЛЬЗОВАТЬ:

### ОДНА КОМАНДА:

```bash
./deploy_auto.sh
```

Всё! Скрипт сам:
1. Проверит архив (создаст если нет)
2. Скопирует на VPS
3. Соберёт проект
4. Установит на сайт
5. Покажет результат

---

## 📋 ЧТО ИЗМЕНЯЕТСЯ НА САЙТЕ:

✅ **"Наши услуги" → "Услуги электрика"**
✅ **Система скидок:**
   - 3+ шт → 5%
   - 5+ шт → 10%
   - 11+ шт → 15%
   - 21+ шт → 20%
✅ **Кнопка "← К услугам" в корзине**

---

## 🧪 ПРОВЕРКА ПОСЛЕ ДЕПЛОЯ:

1. Откройте: https://app.balt-set.ru/
2. Проверьте название "Услуги электрика"
3. Добавьте 3 розетки → скидка 5%
4. В корзине "Редактировать" → кнопка "← К услугам"

---

## ⚙️ ТЕХНИЧЕСКИЕ ДЕТАЛИ:

**Архив:** `electric-service-automation-main.tar.gz` (342 KB)

**VPS:** 176.98.178.109

**Путь на VPS:** `/var/www/app.balt-set.ru/`

**Таймауты:**
- Копирование: 300 сек
- Сборка: 600 сек (npm install + build)

**Автоматизация:**
- Использует `expect` для автоввода пароля
- Временные скрипты в `/tmp/`
- Автоочистка после завершения

---

## 💡 ЕСЛИ ЧТО-ТО ПОШЛО НЕ ТАК:

### Скрипт показывает ошибку?

Скрипт автоматически выведет команды для ручного деплоя:

```bash
scp electric-service-automation-main.tar.gz root@176.98.178.109:/tmp/
ssh root@176.98.178.109
cd /tmp && tar -xzf electric-service-automation-main.tar.gz && cd electric-service-automation-main && npm install && npm run build && cp -r dist/* /var/www/app.balt-set.ru/ && chmod -R 755 /var/www/app.balt-set.ru/
```

Пароль: `pneDRE2K?Tz1k-`

---

## 📊 ПРИМЕРЫ СКИДОК:

### Розетки (250 ₽):
```
1 шт  = 250 ₽
3 шт  = 712.5 ₽   (↓ 37.5 ₽)   ← 5%
6 шт  = 1,350 ₽   (↓ 150 ₽)   ← 10%
11 шт = 2,337.5 ₽ (↓ 412.5 ₽) ← 15%
21 шт = 4,200 ₽   (↓ 1,050 ₽) ← 20%
```

### Выключатели (350 ₽):
```
1 шт = 350 ₽
3 шт = 997.5 ₽  (↓ 52.5 ₽)  ← 5%
6 шт = 1,890 ₽  (↓ 210 ₽)   ← 10%
```

### Светильники (1000 ₽):
```
1 шт = 1,000 ₽
3 шт = 2,850 ₽  (↓ 150 ₽)  ← 5%
```

---

## 🎨 ВИЗУАЛЬНЫЕ ИЗМЕНЕНИЯ:

### ДО:
```
┌─────────────────────────────┐
│  Наши услуги                │
├─────────────────────────────┤
│ ☐ Установить розетку: 250₽ │
│   Количество: [1] [+][-]    │
└─────────────────────────────┘
```

### ПОСЛЕ:
```
┌─────────────────────────────────────────┐
│  Услуги электрика                       │
├─────────────────────────────────────────┤
│ ☐ Установить розетку: 250₽             │
│   Количество: [3] [+][-]                │
│   ✓ Скидка 5% от 3 шт. Применена! 🟢   │
│   Цена: 712.5 ₽                         │
└─────────────────────────────────────────┘

В корзине:
┌─────────────────────────────────────────┐
│ Задачи          [Редактировать] [🗑]    │
├─────────────────────────────────────────┤
│ #1 Установить розетку                   │
│ [-] 3 ед [+] [🗑] [← К услугам]        │
└─────────────────────────────────────────┘
```

---

## 📚 ВСЯ ДОКУМЕНТАЦИЯ:

1. **АВТОДЕПЛОЙ.md** ← Вы здесь
2. **КОМАНДЫ_ДЛЯ_ДЕПЛОЯ.txt** - Ручные команды
3. **ФИНАЛЬНАЯ_ИНСТРУКЦИЯ.md** - Подробная инструкция
4. **README_ДЕПЛОЙ.md** - Быстрый старт
5. **ДЕПЛОЙ_УЛУЧШЕНИЙ.md** - Детали изменений
6. **УЛУЧШЕНИЯ_СИСТЕМЫ_РЕАЛИЗОВАНО.md** - Технические детали

---

## 🚀 ЗАПУСК АВТОДЕПЛОЯ:

```bash
# Просто запустите:
./deploy_auto.sh

# Или с правами:
chmod +x deploy_auto.sh && ./deploy_auto.sh
```

---

## ✅ ВСЁ ГОТОВО!

Запускай `./deploy_auto.sh` и всё задеплоится автоматически! 🎉

После деплоя проверь: **https://app.balt-set.ru/**
