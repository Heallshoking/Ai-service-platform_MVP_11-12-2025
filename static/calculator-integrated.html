<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–º–µ—Ç–∞ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂ –∑–∞ 2 –º–∏–Ω—É—Ç—ã | –ë–ê–õ–¢–°–ï–¢–¨</title>
    <meta name="description" content="–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–∞ –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–µ –∑–∞ 2 –º–∏–Ω—É—Ç—ã. –°–∏—Å—Ç–µ–º–∞ —Å–∫–∏–¥–æ–∫ –¥–æ 25%. –¢–æ—á–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å —É—á–µ—Ç–æ–º —Ç–∏–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏—è.">
    <meta name="keywords" content="–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —ç–ª–µ–∫—Ç—Ä–∏–∫–∞, —Ä–∞—Å—á–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–∞, —Å–º–µ—Ç–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂ –∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥">
    
    <!-- Open Graph -->
    <meta property="og:title" content="–°–º–µ—Ç–∞ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂ –∑–∞ 2 –º–∏–Ω—É—Ç—ã | –ë–ê–õ–¢–°–ï–¢–¨">
    <meta property="og:description" content="–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã—Ö —Ä–∞–±–æ—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–∫–∏–¥–æ–∫">
    <meta property="og:image" content="https://app.balt-set.ru/og-calculator.jpg">
    <meta property="og:url" content="https://app.balt-set.ru/calculator-integrated.html">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.95) 0%, rgba(118, 75, 162, 0.95) 100%),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%2366b3ff" width="1200" height="400"/><path fill="%23ffffff" opacity="0.1" d="M0,160 Q300,100 600,160 T1200,160 L1200,400 L0,400 Z"/></svg>');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
        }
        
        /* –§–∏—Ä–º–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–∞ –∫–∞–∫ —Ñ–æ–Ω */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: linear-gradient(180deg, rgba(66, 133, 244, 0.85) 0%, rgba(66, 133, 244, 0.75) 50%, rgba(66, 133, 244, 0.85) 100%);
            z-index: -2;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 20px 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .phone {
            color: #667eea;
            font-weight: 600;
            text-decoration: none;
            font-size: 1.1rem;
        }
        
        .search-chat-container {
            display: flex;
            gap: 10px;
            align-items: center;
            flex: 1;
            max-width: 500px;
            margin: 0 20px;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.2s;
            background: white;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .chat-send-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chat-send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .hero {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .hero p {
            font-size: 1.25rem;
            opacity: 0.95;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            margin-bottom: 20px;
            animation: cardAppear 0.6s ease-out;
        }
        
        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1d1d1f;
        }
        
        .step {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: start;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-content h3 {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #1d1d1f;
        }
        
        .step-content p {
            color: #666;
            font-size: 0.95rem;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }
        
        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s;
            background: white;
            font-family: inherit;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .room-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .room-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        
        .room-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }
        
        .room-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .room-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: #1d1d1f;
        }
        
        .room-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .services-list {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        
        .service-item {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .service-info h4 {
            font-weight: 600;
            margin-bottom: 5px;
            color: #1d1d1f;
        }
        
        .service-info p {
            font-size: 0.9rem;
            color: #666;
        }
        
        .service-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }
        
        .qty-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qty-btn:hover {
            background: #667eea;
            color: white;
        }
        
        .qty-display {
            min-width: 40px;
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .summary {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            border-radius: 16px;
            padding: 25px;
            margin-top: 30px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }
        
        .summary-row:last-child {
            border-bottom: none;
        }
        
        .summary-label {
            font-weight: 500;
            color: #333;
        }
        
        .summary-value {
            font-weight: 700;
            color: #667eea;
        }
        
        .total-row {
            font-size: 1.5rem;
            font-weight: 800;
            color: #1d1d1f;
            margin-top: 15px;
        }
        
        .discount-badge {
            background: #10b981;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .btn {
            width: 100%;
            padding: 18px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #f8f9fa;
        }
        
        .info-banner {
            background: linear-gradient(135deg, #60a5fa, #3b82f6);
            color: white;
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .info-banner h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .info-banner a {
            color: white;
            text-decoration: underline;
            font-weight: 600;
        }
        
        .telegram-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #0088cc;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.2s;
        }
        
        .telegram-link:hover {
            background: #006699;
            transform: translateY(-2px);
        }
        
        .hidden {
            display: none;
        }
        
        /* Phone Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
            position: relative;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .btn-trust {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
            transition: all 0.3s ease;
        }
        
        .btn-trust:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
            transform: translateY(-2px);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #999;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .modal-close:hover {
            background: #f3f4f6;
            color: #333;
        }
        
        .modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: #1d1d1f;
        }
        
        .modal-subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.05rem;
        }
        
        .timer-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }
        
        .verification-note {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #92400e;
        }
        
        .telegram-option {
            background: linear-gradient(135deg, #0088cc, #006699);
            color: white;
            padding: 18px;
            border-radius: 16px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 15px;
            border: none;
            width: 100%;
            text-align: left;
        }
        
        .telegram-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 136, 204, 0.4);
        }
        
        .telegram-icon {
            font-size: 2rem;
        }
        
        .telegram-text h4 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .telegram-text p {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .divider {
            text-align: center;
            margin: 20px 0;
            color: #999;
            font-size: 0.9rem;
            position: relative;
        }
        
        .divider::before,
        .divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #e5e7eb;
        }
        
        .divider::before {
            left: 0;
        }
        
        .divider::after {
            right: 0;
        }
        
        .blur-results {
            filter: blur(8px);
            pointer-events: none;
            user-select: none;
        }
        
        .locked-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 100;
        }
        
        .lock-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .search-chat-container {
                width: 100%;
                max-width: 100%;
                margin: 0;
            }
            
            .chat-input {
                font-size: 0.95rem;
            }
            
            .phone {
                font-size: 1rem;
            }
            
            .hero h1 {
                font-size: 1.8rem;
            }
            
            .card {
                padding: 25px;
            }
            
            .room-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 30px 20px;
                width: 95%;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">‚ö° –ë–ê–õ–¢–°–ï–¢–¨</div>
            <div class="search-chat-container">
                <input type="text" id="chatInput" class="chat-input" placeholder="üí¨ –ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å —ç–ª–µ–∫—Ç—Ä–∏–∫—É..." />
                <button class="chat-send-btn" onclick="sendChatMessage()">üì§</button>
            </div>
            <a href="tel:+74012520725" class="phone">+7 (4012) 52-07-25</a>
        </div>
        
        <div class="hero">
            <h1>–°–º–µ—Ç–∞ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂<br>–ó–ê 2 –ú–ò–ù–£–¢–´</h1>
            <p>–¢–æ—á–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º —Ç–∏–ø–∞ –ø–æ–º–µ—â–µ–Ω–∏—è</p>
        </div>
        
        <!-- Step 1: Room Selection -->
        <div class="card" id="step1">
            <div class="section-title">–®–∞–≥ 1: –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è</div>
            
            <div class="room-grid">
                <div class="room-card" onclick="selectRoom('studio', 'üè†', '–°—Ç—É–¥–∏—è', 3, 8)">
                    <div class="room-icon">üè†</div>
                    <div class="room-name">–°—Ç—É–¥–∏—è</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~30–º¬≤</p>
                </div>
                
                <div class="room-card" onclick="selectRoom('oneroom', 'üèòÔ∏è', '1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', 5, 10)">
                    <div class="room-icon">üèòÔ∏è</div>
                    <div class="room-name">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~40–º¬≤</p>
                </div>
                
                <div class="room-card" onclick="selectRoom('tworoom', 'üè°', '2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', 7, 14)">
                    <div class="room-icon">üè°</div>
                    <div class="room-name">2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~60–º¬≤</p>
                </div>
                
                <div class="room-card" onclick="selectRoom('threeroom', 'üèòÔ∏è', '3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è', 9, 18)">
                    <div class="room-icon">üèòÔ∏è</div>
                    <div class="room-name">3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~80–º¬≤</p>
                </div>
                
                <div class="room-card" onclick="selectRoom('house', 'üè∞', '–ß–∞—Å—Ç–Ω—ã–π –¥–æ–º', 12, 25)">
                    <div class="room-icon">üè∞</div>
                    <div class="room-name">–ß–∞—Å—Ç–Ω—ã–π –¥–æ–º</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~120–º¬≤</p>
                </div>
                
                <div class="room-card" onclick="selectRoom('office', 'üè¢', '–û—Ñ–∏—Å/–ö–æ–º–º–µ—Ä—Ü–∏—è', 8, 20)">
                    <div class="room-icon">üè¢</div>
                    <div class="room-name">–û—Ñ–∏—Å</div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">~70–º¬≤</p>
                </div>
            </div>
            
            <div id="roomStats" class="hidden" style="margin-top: 30px;">
                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border-radius: 16px; padding: 25px;">
                    <p style="font-weight: 600; margin-bottom: 15px; color: #333;">üìä –°—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è <span id="selectedRoomName"></span>:</p>
                    <div class="room-stats">
                        <div class="stat-box">
                            <div class="stat-number" id="switchesCount">0</div>
                            <div class="stat-label">–í—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number" id="outletsCount">0</div>
                            <div class="stat-label">–†–æ–∑–µ—Ç–æ–∫</div>
                        </div>
                    </div>
                    <p style="font-size: 0.85rem; color: #666; margin-top: 15px;">* –°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –£—Ç–æ—á–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ.</p>
                </div>
                
                <button class="btn btn-primary" onclick="requestPhoneBeforeCalculation()">üìä –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å ‚Üí</button>
            </div>
        </div>
        
        <!-- Step 2: Service Selection -->
        <div class="card hidden" id="step2">
            <div class="section-title">–®–∞–≥ 2: –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥–∏</div>
            
            <div class="services-list">
                <div class="service-item">
                    <div class="service-info">
                        <h4>üîå –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–æ–∑–µ—Ç–∫–∏</h4>
                        <p>–° –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ–º, —Å–∫—Ä—ã—Ç–∞—è –ø—Ä–æ–≤–æ–¥–∫–∞</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="changeQty('outlets', -1)">-</button>
                            <div class="qty-display" id="qty-outlets">0</div>
                            <button class="qty-btn" onclick="changeQty('outlets', 1)">+</button>
                        </div>
                    </div>
                    <div class="service-price">700 ‚ÇΩ</div>
                </div>
                
                <div class="service-item">
                    <div class="service-info">
                        <h4>üí° –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è</h4>
                        <p>1-2-3 –∫–ª–∞–≤–∏—à–Ω—ã–π, —Å–∫—Ä—ã—Ç–∞—è –ø—Ä–æ–≤–æ–¥–∫–∞</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="changeQty('switches', -1)">-</button>
                            <div class="qty-display" id="qty-switches">0</div>
                            <button class="qty-btn" onclick="changeQty('switches', 1)">+</button>
                        </div>
                    </div>
                    <div class="service-price">600 ‚ÇΩ</div>
                </div>
                
                <div class="service-item">
                    <div class="service-info">
                        <h4>‚ö° –®—Ç—Ä–æ–±–ª–µ–Ω–∏–µ –ø–æ–¥ –ø—Ä–æ–≤–æ–¥–∫—É</h4>
                        <p>–í –±–µ—Ç–æ–Ω–µ, –∫–∏—Ä–ø–∏—á–µ (–∑–∞ 1 –º–µ—Ç—Ä)</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="changeQty('chiseling', -1)">-</button>
                            <div class="qty-display" id="qty-chiseling">0</div>
                            <button class="qty-btn" onclick="changeQty('chiseling', 1)">+</button>
                        </div>
                    </div>
                    <div class="service-price">350 ‚ÇΩ</div>
                </div>
                
                <div class="service-item">
                    <div class="service-info">
                        <h4>üî¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∞</h4>
                        <p>–ü–æ—Ç–æ–ª–æ—á–Ω—ã–π, –Ω–∞—Å—Ç–µ–Ω–Ω—ã–π, —Ç–æ—á–µ—á–Ω—ã–π</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="changeQty('lights', -1)">-</button>
                            <div class="qty-display" id="qty-lights">0</div>
                            <button class="qty-btn" onclick="changeQty('lights', 1)">+</button>
                        </div>
                    </div>
                    <div class="service-price">800 ‚ÇΩ</div>
                </div>
                
                <div class="service-item">
                    <div class="service-info">
                        <h4>üè† –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–≤–æ–¥–∫–∏</h4>
                        <p>–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏</p>
                        <div class="quantity-controls">
                            <button class="qty-btn" onclick="changeQty('rewiring', -1)">-</button>
                            <div class="qty-display" id="qty-rewiring">0</div>
                            <button class="qty-btn" onclick="changeQty('rewiring', 1)">+</button>
                        </div>
                    </div>
                    <div class="service-price">–æ—Ç 3000 ‚ÇΩ</div>
                </div>
            </div>
            
            <div class="summary" id="summary">
                <div class="summary-row">
                    <span class="summary-label">–†–æ–∑–µ—Ç–∫–∏ (<span id="sum-outlets">0</span> —à—Ç)</span>
                    <span class="summary-value" id="price-outlets">0 ‚ÇΩ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–í—ã–∫–ª—é—á–∞—Ç–µ–ª–∏ (<span id="sum-switches">0</span> —à—Ç)</span>
                    <span class="summary-value" id="price-switches">0 ‚ÇΩ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–®—Ç—Ä–æ–±–ª–µ–Ω–∏–µ (<span id="sum-chiseling">0</span> –º)</span>
                    <span class="summary-value" id="price-chiseling">0 ‚ÇΩ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–°–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏ (<span id="sum-lights">0</span> —à—Ç)</span>
                    <span class="summary-value" id="price-lights">0 ‚ÇΩ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–ó–∞–º–µ–Ω–∞ –ø—Ä–æ–≤–æ–¥–∫–∏ (<span id="sum-rewiring">0</span> —à—Ç)</span>
                    <span class="summary-value" id="price-rewiring">0 ‚ÇΩ</span>
                </div>
                <div class="summary-row" id="discount-row" style="display: none;">
                    <span class="summary-label">–°–∫–∏–¥–∫–∞</span>
                    <span class="summary-value" style="color: #10b981;" id="discount-amount">-0 ‚ÇΩ</span>
                </div>
                <div class="summary-row total-row">
                    <span>–ò—Ç–æ–≥–æ:</span>
                    <span style="color: #667eea;">
                        <span id="totalPrice">0</span> ‚ÇΩ
                        <span class="discount-badge hidden" id="discountBadge">–°–∫–∏–¥–∫–∞ 0%</span>
                    </span>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="finalizeOrder()">–ü–æ–ª—É—á–∏—Ç—å —Å–º–µ—Ç—É –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω üì±</button>
            <button class="btn btn-secondary" onclick="showStep1()">‚Üê –ù–∞–∑–∞–¥</button>
        </div>
        
        <!-- Step 3: Contact Form -->
        <div class="card hidden" id="step3">
            <div class="section-title">–®–∞–≥ 3: –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏</div>
            
            <form id="orderForm">
                <div class="form-group">
                    <label>–í–∞—à–µ –∏–º—è *</label>
                    <input type="text" class="form-control" id="clientName" placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤" required>
                </div>
                
                <div class="form-group">
                    <label>–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                    <input type="tel" class="form-control" id="clientPhone" placeholder="+7 (___) ___-__-__" required>
                </div>
                
                <div class="form-group">
                    <label>–ê–¥—Ä–µ—Å –≤ –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–µ</label>
                    <input type="text" class="form-control" id="clientAddress" placeholder="—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1">
                </div>
                
                <div class="form-group">
                    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
                    <textarea class="form-control" id="clientComment" rows="3" placeholder="–£–∫–∞–∂–∏—Ç–µ –∂–µ–ª–∞–µ–º–æ–µ –≤—Ä–µ–º—è –≤–∏–∑–∏—Ç–∞ –∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è"></textarea>
                </div>
                
                <div class="summary">
                    <div class="summary-row total-row">
                        <span>–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç:</span>
                        <span style="color: #667eea;"><span id="finalPrice">0</span> ‚ÇΩ</span>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É üìù</button>
                <button type="button" class="btn btn-secondary" onclick="showStep2()">‚Üê –ù–∞–∑–∞–¥</button>
            </form>
        </div>
        
        <div class="info-banner">
            <h3>üëâ –ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã?</h3>
            <p>–ó–∞–¥–∞–π—Ç–µ –∏—Ö –Ω–∞—à–µ–º—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É –≤ Telegram</p>
            <a href="https://t.me/konigelectric" target="_blank" class="telegram-link">
                <span>‚úàÔ∏è</span> –ù–∞–ø–∏—Å–∞—Ç—å –≤ Telegram
            </a>
        </div>
    </div>
    
    <!-- Phone Verification Modal -->
    <div id="phoneModal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close" onclick="closePhoneModal()">√ó</button>
            
            <div class="timer-badge">
                <span>‚è±Ô∏è</span>
                <span>–°–º–µ—Ç–∞ –∑–∞ 60 —Å–µ–∫—É–Ω–¥</span>
            </div>
            
            <h2 class="modal-title">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫</h2>
            <p class="modal-subtitle">–î–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç, —Å —É—á—ë—Ç–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —á—Ç–æ –≤—ã –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫</p>
            
            <div class="verification-note">
                üîí <strong>–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω –Ω–æ–º–µ—Ä?</strong><br>
                –ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–∞–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å–º–µ—Ç—É –∏ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —ç–ª–µ–∫—Ç—Ä–∏–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥!
            </div>
            
            <button class="telegram-option" onclick="useTelegramAuth()">
                <div class="telegram-icon">‚úàÔ∏è</div>
                <div class="telegram-text">
                    <h4>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram</h4>
                    <p>–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –±–æ—Ç–∞ - –æ–¥–∏–Ω –∫–ª–∏–∫!</p>
                </div>
            </button>
            
            <div class="divider">–∏–ª–∏</div>
            
            <form id="phoneVerificationForm" onsubmit="verifyPhone(event)">
                <div class="form-group">
                    <label>–í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ *</label>
                    <input type="tel" class="form-control" id="verifyPhone" placeholder="+7 (___) ___-__-__" required>
                </div>
                
                <button type="submit" class="btn btn-primary btn-trust">
                    üîì –û—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø
                </button>
            </form>
        </div>
    </div>
    
    <script>
        const TELEGRAM_BOT_TOKEN = '8594337620:AAEV59Hi-38xUjTKd70hRTkvcR6miWWWxls';
        const TELEGRAM_CHAT_ID = '-1002468635742';
        
        let userPhone = null;
        let isPhoneVerified = false;
        
        const prices = {
            outlets: 700,
            switches: 600,
            chiseling: 350,
            lights: 800,
            rewiring: 3000
        };
        
        const quantities = {
            outlets: 0,
            switches: 0,
            chiseling: 0,
            lights: 0,
            rewiring: 0
        };
        
        let selectedRoom = null;
        
        function selectRoom(type, icon, name, switches, outlets) {
            selectedRoom = { type, icon, name, switches, outlets };
            
            // Update UI
            document.querySelectorAll('.room-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Show stats
            document.getElementById('selectedRoomName').textContent = name.toLowerCase();
            document.getElementById('switchesCount').textContent = switches;
            document.getElementById('outletsCount').textContent = outlets;
            document.getElementById('roomStats').classList.remove('hidden');
            
            // Pre-fill quantities
            quantities.switches = switches;
            quantities.outlets = outlets;
        }
        
        function showStep1() {
            document.getElementById('step1').classList.remove('hidden');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.add('hidden');
        }
        
        function showStep2() {
            if (!selectedRoom) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è');
                return;
            }
            
            // Update quantities
            document.getElementById('qty-outlets').textContent = quantities.outlets;
            document.getElementById('qty-switches').textContent = quantities.switches;
            
            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.remove('hidden');
            document.getElementById('step3').classList.add('hidden');
            
            updateSummary();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function showStep3() {
            const total = calculateTotal();
            if (total === 0) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —É—Å–ª—É–≥—É');
                return;
            }
            
            document.getElementById('step1').classList.add('hidden');
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.remove('hidden');
            document.getElementById('finalPrice').textContent = total.toLocaleString('ru-RU');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function changeQty(service, delta) {
            quantities[service] = Math.max(0, quantities[service] + delta);
            document.getElementById('qty-' + service).textContent = quantities[service];
            updateSummary();
        }
        
        function calculateTotal() {
            let total = 0;
            for (const [service, qty] of Object.entries(quantities)) {
                total += prices[service] * qty;
            }
            return total;
        }
        
        function getDiscount(total) {
            if (total >= 50000) return 0.25; // 25%
            if (total >= 30000) return 0.15; // 15%
            if (total >= 15000) return 0.10; // 10%
            if (total >= 10000) return 0.05; // 5%
            return 0;
        }
        
        function updateSummary() {
            let subtotal = 0;
            
            for (const [service, qty] of Object.entries(quantities)) {
                const price = prices[service] * qty;
                subtotal += price;
                document.getElementById('sum-' + service).textContent = qty;
                document.getElementById('price-' + service).textContent = price.toLocaleString('ru-RU') + ' ‚ÇΩ';
            }
            
            const discount = getDiscount(subtotal);
            const discountAmount = Math.round(subtotal * discount);
            const total = subtotal - discountAmount;
            
            if (discount > 0) {
                document.getElementById('discount-row').style.display = 'flex';
                document.getElementById('discount-amount').textContent = '-' + discountAmount.toLocaleString('ru-RU') + ' ‚ÇΩ';
                document.getElementById('discountBadge').classList.remove('hidden');
                document.getElementById('discountBadge').textContent = '–°–∫–∏–¥–∫–∞ ' + Math.round(discount * 100) + '%';
            } else {
                document.getElementById('discount-row').style.display = 'none';
                document.getElementById('discountBadge').classList.add('hidden');
            }
            
            document.getElementById('totalPrice').textContent = total.toLocaleString('ru-RU');
        }
        
        // Form submission
        document.getElementById('orderForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('clientName').value;
            const phone = document.getElementById('clientPhone').value;
            const address = document.getElementById('clientAddress').value;
            const comment = document.getElementById('clientComment').value;
            const total = calculateTotal();
            
            // Prepare order details
            const orderDetails = {
                name,
                phone,
                address,
                comment,
                room: selectedRoom,
                services: quantities,
                total: total
            };
            
            console.log('Order submitted:', orderDetails);
            
            // Show success message
            alert(`‚úÖ –°–ø–∞—Å–∏–±–æ, ${name}!

–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å—É–º–º—É ${total.toLocaleString('ru-RU')} ‚ÇΩ –ø—Ä–∏–Ω—è—Ç–∞.

–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É ${phone} –≤ —Ç–µ—á–µ–Ω–∏–µ 15 –º–∏–Ω—É—Ç!`);
            
            // Reset form
            this.reset();
            showStep1();
            
            // In production, send to backend
            // fetch('/api/orders', { method: 'POST', body: JSON.stringify(orderDetails) });
        });
        
        // Phone mask
        document.getElementById('clientPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 0) {
                if (!value.startsWith('7')) {
                    value = '7' + value;
                }
                let formatted = '+7';
                if (value.length > 1) {
                    formatted += ' (' + value.substring(1, 4);
                }
                if (value.length >= 5) {
                    formatted += ') ' + value.substring(4, 7);
                }
                if (value.length >= 8) {
                    formatted += '-' + value.substring(7, 9);
                }
                if (value.length >= 10) {
                    formatted += '-' + value.substring(9, 11);
                }
                e.target.value = formatted;
            }
        });
        
        // –£–º–Ω–∞—è –º–∞—Å–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç)
        function formatPhoneNumber(input) {
            // –£–¥–∞–ª—è–µ–º –≤—Å—ë –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä
            let value = input.value.replace(/\D/g, '');
            
            // –ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 8, –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ 7
            if (value.startsWith('8')) {
                value = '7' + value.slice(1);
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 7, –¥–æ–±–∞–≤–ª—è–µ–º
            if (value.length > 0 && !value.startsWith('7')) {
                value = '7' + value;
            }
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 11 —Ü–∏—Ñ—Ä–∞–º–∏
            value = value.slice(0, 11);
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º: +7 (XXX) XXX-XX-XX
            let formatted = '';
            if (value.length > 0) {
                formatted = '+7';
                if (value.length > 1) {
                    formatted += ' (' + value.slice(1, 4);
                }
                if (value.length >= 5) {
                    formatted += ') ' + value.slice(4, 7);
                }
                if (value.length >= 8) {
                    formatted += '-' + value.slice(7, 9);
                }
                if (value.length >= 10) {
                    formatted += '-' + value.slice(9, 11);
                }
            }
            
            input.value = formatted;
            return value;
        }
        
        // Phone mask for verification modal
        document.getElementById('verifyPhone').addEventListener('input', function(e) {
            formatPhoneNumber(e.target);
        });
        
        // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞
        document.getElementById('verifyPhone').addEventListener('focus', function(e) {
            if (!e.target.value) {
                e.target.value = '+7 (';
            }
        });
        
        // Phone mask for order form
        document.getElementById('clientPhone').addEventListener('input', function(e) {
            formatPhoneNumber(e.target);
        });
        
        // === –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò ===
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram —á–∞—Ç
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ');
                return;
            }
            
            // –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è Telegram
            const telegramMessage = `üí¨ –ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞:

${message}

‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
üïó ${new Date().toLocaleString('ru-RU')}`;
            
            try {
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
                const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: telegramMessage,
                        parse_mode: 'HTML'
                    })
                });
                
                if (response.ok) {
                    input.value = '';
                    alert('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ! –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç.');
                } else {
                    throw new Error('Failed to send');
                }
            } catch (error) {
                console.error('Telegram send error:', error);
                // Fallback: –æ—Ç–∫—Ä—ã—Ç—å Telegram —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
                const encodedMessage = encodeURIComponent(message);
                window.open(`https://t.me/konigelectric?text=${encodedMessage}`, '_blank');
                input.value = '';
            }
        }
        
        // Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–∞—Ç–∞
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
        
        // –ó–∞–ø—Ä–æ—Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–æ–º
        function requestPhoneBeforeCalculation() {
            if (!selectedRoom) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–æ–º–µ—â–µ–Ω–∏—è');
                return;
            }
            
            if (isPhoneVerified) {
                // –ï—Å–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
                showStep2();
            } else {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                document.getElementById('phoneModal').classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closePhoneModal() {
            // –†–µ–¥–∏—Ä–µ–∫—Ç –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–∫—Ä—ã—Ç—å
            if (document.referrer && document.referrer !== window.location.href) {
                // –ï—Å–ª–∏ –ø—Ä–∏—à—ë–ª —Å –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω–∞–∑–∞–¥
                window.history.back();
            } else {
                // –ò–Ω–∞—á–µ - –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                window.location.href = 'https://app.balt-set.ru/';
            }
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
        function verifyPhone(event) {
            event.preventDefault();
            
            const phone = document.getElementById('verifyPhone').value;
            
            if (!phone || phone.length < 10) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
                return;
            }
            
            userPhone = phone;
            isPhoneVerified = true;
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
            sendLeadToTelegram(phone, '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–º–µ—Ç—ã');
            
            closePhoneModal();
            showStep2();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            setTimeout(() => {
                alert('‚úÖ –û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞');
            }, 300);
        }
        
        // Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
        function useTelegramAuth() {
            // –û—Ç–∫—Ä—ã—Ç—å Telegram –±–æ—Ç–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä
            const botUsername = 'Baltset39_bot';
            const message = '–•–æ—á—É –ø–æ–ª—É—á–∏—Ç—å —Å–º–µ—Ç—É –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂! –û—Ç–ø—Ä–∞–≤–ª—è—é –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞';
            
            window.open(`https://t.me/${botUsername}?start=estimate`, '_blank');
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Telegram Web App)
            setTimeout(() => {
                const confirmed = confirm('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ Telegram?');
                if (confirmed) {
                    userPhone = 'Telegram';
                    isPhoneVerified = true;
                    closePhoneModal();
                    showStep2();
                }
            }, 2000);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∏–¥–∞ –≤ Telegram
        async function sendLeadToTelegram(phone, source) {
            const roomInfo = selectedRoom ? `${selectedRoom.icon} ${selectedRoom.name}` : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
            
            const message = `üìû <b>–ù–û–í–´–ô –õ–ò–î!</b>\n\n` +
                          `üë§ –¢–µ–ª–µ—Ñ–æ–Ω: <code>${phone}</code>\n` +
                          `üè† –ü–æ–º–µ—â–µ–Ω–∏–µ: ${roomInfo}\n` +
                          `üìä –ò—Å—Ç–æ—á–Ω–∏–∫: ${source}\n` +
                          `üïó –í—Ä–µ–º—è: ${new Date().toLocaleString('ru-RU')}`;
            
            try {
                await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
            } catch (error) {
                console.error('Error sending to Telegram:', error);
            }
        }
        
        // –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞
        function finalizeOrder() {
            const total = calculateTotal();
            if (total === 0) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —É—Å–ª—É–≥—É');
                return;
            }
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å–º–µ—Ç—ã –≤ Telegram
            sendDetailedEstimate();
            
            alert(`‚úÖ –û—Ç–ª–∏—á–Ω–æ!

–°–º–µ—Ç–∞ –Ω–∞ —Å—É–º–º—É ${total.toLocaleString('ru-RU')} ‚ÇΩ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω ${userPhone}

–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥!`);
            
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            setTimeout(() => {
                showStep1();
                isPhoneVerified = false;
                userPhone = null;
            }, 3000);
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å–º–µ—Ç—ã
        async function sendDetailedEstimate() {
            const discount = getDiscount(calculateTotal());
            const subtotal = calculateTotal() / (1 - discount);
            const discountAmount = Math.round(subtotal * discount);
            const total = calculateTotal();
            
            let servicesText = '';
            for (const [service, qty] of Object.entries(quantities)) {
                if (qty > 0) {
                    const serviceName = {
                        outlets: 'üîå –†–æ–∑–µ—Ç–∫–∏',
                        switches: 'üí° –í—ã–∫–ª—é—á–∞—Ç–µ–ª–∏',
                        chiseling: '‚ö° –®—Ç—Ä–æ–±–ª–µ–Ω–∏–µ',
                        lights: 'üî¶ –°–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏',
                        rewiring: 'üè† –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–≤–æ–¥–∫–∏'
                    }[service];
                    const price = prices[service] * qty;
                    servicesText += `${serviceName}: ${qty} —à—Ç \u00d7 ${prices[service]} ‚ÇΩ = ${price.toLocaleString('ru-RU')} ‚ÇΩ\n`;
                }
            }
            
            const message = `üìÑ <b>–î–ï–¢–ê–õ–¨–ù–ê–Ø –°–ú–ï–¢–ê</b>\n\n` +
                          `üë§ –¢–µ–ª–µ—Ñ–æ–Ω: <code>${userPhone}</code>\n` +
                          `üè† –ü–æ–º–µ—â–µ–Ω–∏–µ: ${selectedRoom.icon} ${selectedRoom.name}\n\n` +
                          `<b>–£—Å–ª—É–≥–∏:</b>\n${servicesText}\n` +
                          (discount > 0 ? `üéÅ –°–∫–∏–¥–∫–∞ ${Math.round(discount * 100)}%: -${discountAmount.toLocaleString('ru-RU')} ‚ÇΩ\n\n` : '\n') +
                          `üí∞ <b>–ò–¢–û–ì–û: ${total.toLocaleString('ru-RU')} ‚ÇΩ</b>\n\n` +
                          `üïó ${new Date().toLocaleString('ru-RU')}`;
            
            try {
                await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
            } catch (error) {
                console.error('Error sending estimate:', error);
            }
        }
    </script>
    
    <!-- Yandex.Metrika -->
    <script type="text/javascript">
       (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();
       for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
       k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
       (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
       ym(98765432, "init", {clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/98765432" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
</body>
</html>